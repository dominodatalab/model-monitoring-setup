import base64
from pathlib import Path

content = base64.b64decode('IyEvdXNyL2Jpbi9lbnYgcHl0aG9uMwoiIiIKU2NoZWR1bGVkIEN1c3RvbSBNZXRyaWMgSm9iOiBLb2xtb2dvcm92LVNtaXJub3ZfVGVzdF9kcmlmdApHZW5lcmF0ZWQgYXV0b21hdGljYWxseSBmcm9tIE1vZGVsIE1vbml0b3JpbmcgQXBwCk1ldHJpYyBUeXBlOiBLb2xtb2dvcm92LVNtaXJub3YgVGVzdApNb2RlbDogTW9uaXRvcmluZyBTZXR1cCBFeGFtcGxlIHY5CiIiIgoKaW1wb3J0IHBhbmRhcyBhcyBwZAppbXBvcnQgbnVtcHkgYXMgbnAKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQpmcm9tIHBhdGhsaWIgaW1wb3J0IFBhdGgKaW1wb3J0IHN5cwppbXBvcnQgb3MKCiMgSW1wb3J0IERvbWlubyBTREsKaW1wb3J0IGRvbWlubwoKIyBBZGQgcHJvamVjdCBpbXBvcnRzIGlmIG5lZWRlZAp0cnk6CiAgICBmcm9tIGRvbWlub19kYXRhLnRyYWluaW5nX3NldHMuY2xpZW50IGltcG9ydCAoCiAgICAgICAgbGlzdF90cmFpbmluZ19zZXRzLAogICAgICAgIGxpc3RfdHJhaW5pbmdfc2V0X3ZlcnNpb25zLAogICAgICAgIGdldF90cmFpbmluZ19zZXRfdmVyc2lvbgogICAgKQogICAgVFJBSU5JTkdfU0VUU19BVkFJTEFCTEUgPSBUcnVlCmV4Y2VwdCBJbXBvcnRFcnJvcjoKICAgIFRSQUlOSU5HX1NFVFNfQVZBSUxBQkxFID0gRmFsc2UKCmZyb20gc2NpcHkgaW1wb3J0IHN0YXRzCmZyb20gc2NpcHkuc3RhdHMgaW1wb3J0IGVudHJvcHkKZnJvbSBzY2lweS5zcGF0aWFsIGltcG9ydCBkaXN0YW5jZQoKIyA9PT09PT09PT09PT09PT09PT09PSBDb25maWd1cmF0aW9uID09PT09PT09PT09PT09PT09PT09Ck1FVFJJQ19OQU1FID0gIktvbG1vZ29yb3YtU21pcm5vdl9UZXN0X2RyaWZ0IgpNT0RFTF9JRCA9ICI2OTBlYjExNmZjYzY3NmMzNjRhNzA0ZWYiCk1PREVMX05BTUUgPSAiTW9uaXRvcmluZyBTZXR1cCBFeGFtcGxlIHY5IgoKIyBEb21pbm8gcHJvamVjdCBjb25maWd1cmF0aW9uCkRPTUlOT19QUk9KRUNUX09XTkVSID0gb3MuZW52aXJvbi5nZXQoIkRPTUlOT19QUk9KRUNUX09XTkVSIiwgImFuZHJlYV9sb3dlIikKRE9NSU5PX1BST0pFQ1RfTkFNRSA9IG9zLmVudmlyb24uZ2V0KCJET01JTk9fUFJPSkVDVF9OQU1FIiwgIm1vZGVsLW1vbml0b3JpbmctdHV0b3JpYWwiKQpET01JTk9fUFJPSkVDVCA9IGYie0RPTUlOT19QUk9KRUNUX09XTkVSfS97RE9NSU5PX1BST0pFQ1RfTkFNRX0iCkFQSV9IT1NUID0gImh0dHBzOi8vc2UtZGVtby5kb21pbm8udGVjaCIKQVBJX0tFWSA9IG9zLmVudmlyb24uZ2V0KCJET01JTk9fVVNFUl9BUElfS0VZIiwgIiIpCgojID09PT09PT09PT09PT09PT09PT09IERhdGEgTG9hZGluZyBGdW5jdGlvbnMgPT09PT09PT09PT09PT09PT09PT0KCmRlZiBsb2FkX2Jhc2VsaW5lX2RhdGEoKToKICAgICIiIkxvYWQgYmFzZWxpbmUgZGF0YSBmb3IgbWV0cmljIGNvbXB1dGF0aW9uLiIiIgogICAgaWYgbm90IFRSQUlOSU5HX1NFVFNfQVZBSUxBQkxFOgogICAgICAgIHJhaXNlIEV4Y2VwdGlvbigiVHJhaW5pbmcgU2V0cyBBUEkgbm90IGF2YWlsYWJsZSIpCiAgICAKICAgIHRyYWluaW5nX3NldF9uYW1lID0gImV4YW1wbGVfdHJhaW5pbmdfc2V0X2FuZHJlYV9sb3dlIgogICAgdmVyc2lvbnMgPSBsaXN0X3RyYWluaW5nX3NldF92ZXJzaW9ucyh0cmFpbmluZ19zZXRfbmFtZT10cmFpbmluZ19zZXRfbmFtZSkKICAgIGlmIG5vdCB2ZXJzaW9uczoKICAgICAgICByYWlzZSBFeGNlcHRpb24oZiJObyB2ZXJzaW9ucyBmb3VuZCBmb3IgdHJhaW5pbmcgc2V0IFwie3RyYWluaW5nX3NldF9uYW1lfVwiIikKICAgIAogICAgbGF0ZXN0X3ZlcnNpb24gPSBtYXgodmVyc2lvbnMsIGtleT1sYW1iZGEgdjogdi5udW1iZXIpCiAgICB0c192ZXJzaW9uID0gZ2V0X3RyYWluaW5nX3NldF92ZXJzaW9uKHRyYWluaW5nX3NldF9uYW1lLCBsYXRlc3RfdmVyc2lvbi5udW1iZXIpCiAgICBkZiA9IHRzX3ZlcnNpb24ubG9hZF90cmFpbmluZ19wYW5kYXMoKQogICAgCiAgICBwcmludChmIuKchSBMb2FkZWQge2xlbihkZik6LH0gdHJhaW5pbmcgc2FtcGxlcyBmcm9tIFwie3RyYWluaW5nX3NldF9uYW1lfVwiICh2ZXJzaW9uIHtsYXRlc3RfdmVyc2lvbi5udW1iZXJ9KSIpCiAgICByZXR1cm4gZGYKCmRlZiBsb2FkX2N1cnJlbnRfZGF0YSgpOgogICAgIiIiTG9hZCBjdXJyZW50IHByZWRpY3Rpb24gZGF0YSBmb3IgbWV0cmljIGNvbXB1dGF0aW9uLiIiIgogICAgZGF5cyA9IDcKICAgIGVuZF9kYXRlID0gZGF0ZXRpbWUubm93KCkKICAgIHN0YXJ0X2RhdGUgPSBlbmRfZGF0ZSAtIHRpbWVkZWx0YShkYXlzPWRheXMpCiAgICAKICAgICMgVHJ5IHRvIGxvYWQgZnJvbSBwcmVkaWN0aW9uIGRhdGEgZGlyZWN0b3J5CiAgICBwcmVkaWN0aW9uX2Jhc2UgPSBQYXRoKCIvbW50L2RhdGEvcHJlZGljdGlvbl9kYXRhIikKICAgIG1vZGVsX2RpciA9IHByZWRpY3Rpb25fYmFzZSAvIE1PREVMX0lECiAgICAKICAgIGlmIG1vZGVsX2Rpci5leGlzdHMoKToKICAgICAgICAjIExvYWQgcHJlZGljdGlvbiBmaWxlcyB3aXRoaW4gZGF0ZSByYW5nZQogICAgICAgIGFsbF9maWxlcyA9IFtdCiAgICAgICAgY3VycmVudF9kYXRlID0gc3RhcnRfZGF0ZS5kYXRlKCkKICAgICAgICBlbmRfZGF0ZV9vbmx5ID0gZW5kX2RhdGUuZGF0ZSgpCiAgICAgICAgCiAgICAgICAgd2hpbGUgY3VycmVudF9kYXRlIDw9IGVuZF9kYXRlX29ubHk6CiAgICAgICAgICAgIGRhdGVfc3RyID0gY3VycmVudF9kYXRlLnN0cmZ0aW1lKCIlWS0lbS0lZCIpICsgIloiCiAgICAgICAgICAgIGRhdGVfZGlyID0gbW9kZWxfZGlyIC8gZiIkJGRhdGUkJD17ZGF0ZV9zdHJ9IgogICAgICAgICAgICAKICAgICAgICAgICAgaWYgZGF0ZV9kaXIuZXhpc3RzKCk6CiAgICAgICAgICAgICAgICBmb3IgaG91cl9kaXIgaW4gZGF0ZV9kaXIuaXRlcmRpcigpOgogICAgICAgICAgICAgICAgICAgIGlmIGhvdXJfZGlyLmlzX2RpcigpIGFuZCBob3VyX2Rpci5uYW1lLnN0YXJ0c3dpdGgoIiQkaG91ciQkPSIpOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgZmlsZV9wYXRoIGluIGhvdXJfZGlyLmdsb2IoIioucGFycXVldCIpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsX2ZpbGVzLmFwcGVuZChmaWxlX3BhdGgpCiAgICAgICAgICAgIAogICAgICAgICAgICBjdXJyZW50X2RhdGUgKz0gdGltZWRlbHRhKGRheXM9MSkKICAgICAgICAKICAgICAgICBpZiBhbGxfZmlsZXM6CiAgICAgICAgICAgIGRmcyA9IFtdCiAgICAgICAgICAgIGZvciBmaWxlX3BhdGggaW4gYWxsX2ZpbGVzOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGRmX3RlbXAgPSBwZC5yZWFkX3BhcnF1ZXQoZmlsZV9wYXRoKQogICAgICAgICAgICAgICAgICAgIGRmcy5hcHBlbmQoZGZfdGVtcCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBwcmludChmIkNvdWxkIG5vdCBsb2FkIHtmaWxlX3BhdGgubmFtZX06IHtlfSIpCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBkZnM6CiAgICAgICAgICAgICAgICBkZiA9IHBkLmNvbmNhdChkZnMsIGlnbm9yZV9pbmRleD1UcnVlKQogICAgICAgICAgICAgICAgZmVhdHVyZV9jb2xzID0gW2NvbCBmb3IgY29sIGluIGRmLmNvbHVtbnMgaWYgImZlYXR1cmUiIGluIGNvbF0KICAgICAgICAgICAgICAgIGlmIGZlYXR1cmVfY29sczoKICAgICAgICAgICAgICAgICAgICBwcmludChmIuKchSBMb2FkZWQge2xlbihkZik6LH0gcHJlZGljdGlvbiByZWNvcmRzIHdpdGgge2xlbihmZWF0dXJlX2NvbHMpfSBmZWF0dXJlcyIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRmW2ZlYXR1cmVfY29sc10KICAgIAogICAgIyBGYWxsYmFjazogdXNlIHRyYWluaW5nIGRhdGEgYXMgcHJveHkKICAgIHByaW50KCLimqDvuI8gVXNpbmcgdHJhaW5pbmcgZGF0YSBhcyBwcm94eSBmb3IgY3VycmVudCBwcmVkaWN0aW9ucyIpCiAgICBkZiA9IGxvYWRfYmFzZWxpbmVfZGF0YSgpCiAgICBzYW1wbGVfc2l6ZSA9IG1pbigxMDAwLCBsZW4oZGYpKQogICAgcmV0dXJuIGRmLnNhbXBsZShuPXNhbXBsZV9zaXplLCByYW5kb21fc3RhdGU9NDIpCgojID09PT09PT09PT09PT09PT09PT09IE1ldHJpYyBDb21wdXRhdGlvbiBGdW5jdGlvbiA9PT09PT09PT09PT09PT09PT09PQoKZGVmIGNvbXB1dGVfbWV0cmljKGJhc2VsaW5lX2RhdGEsIGN1cnJlbnRfZGF0YSk6CiAgICAiIiJDb21wdXRlIEtvbG1vZ29yb3YtU21pcm5vdiBUZXN0IG1ldHJpYy4iIiIKICAgIGZyb20gc2NpcHkgaW1wb3J0IHN0YXRzCiAgICBpbXBvcnQgbnVtcHkgYXMgbnAKICAgIAogICAgcmVzdWx0cyA9IFtdCiAgICBmb3IgY29sdW1uIGluIGJhc2VsaW5lX2RhdGEuY29sdW1uczoKICAgICAgICBrc19zdGF0LCBwX3ZhbHVlID0gc3RhdHMua3NfMnNhbXAoCiAgICAgICAgICAgIGJhc2VsaW5lX2RhdGFbY29sdW1uXS5kcm9wbmEoKSwKICAgICAgICAgICAgY3VycmVudF9kYXRhW2NvbHVtbl0uZHJvcG5hKCkKICAgICAgICApCiAgICAgICAgcmVzdWx0cy5hcHBlbmQoewogICAgICAgICAgICAiZmVhdHVyZSI6IGNvbHVtbiwKICAgICAgICAgICAgImtzX3N0YXRpc3RpYyI6IGtzX3N0YXQsCiAgICAgICAgICAgICJwX3ZhbHVlIjogcF92YWx1ZSwKICAgICAgICAgICAgImRyaWZ0ZWQiOiBrc19zdGF0ID4gMC4wNSBvciBwX3ZhbHVlIDwgMC4wNQogICAgICAgIH0pCiAgICAKICAgIGRyaWZ0ZWRfZmVhdHVyZXMgPSBbciBmb3IgciBpbiByZXN1bHRzIGlmIHJbImRyaWZ0ZWQiXV0KICAgIG1heF9rcyA9IG1heChbclsia3Nfc3RhdGlzdGljIl0gZm9yIHIgaW4gcmVzdWx0c10pCiAgICAKICAgIHJldHVybiB7CiAgICAgICAgInZhbHVlIjogZmxvYXQobWF4X2tzKSwKICAgICAgICAibWV0YWRhdGEiOiB7CiAgICAgICAgICAgICJ0b3RhbF9mZWF0dXJlcyI6IGxlbihyZXN1bHRzKSwKICAgICAgICAgICAgImRyaWZ0ZWRfZmVhdHVyZXMiOiBsZW4oZHJpZnRlZF9mZWF0dXJlcyksCiAgICAgICAgICAgICJiYXNlbGluZV9zYW1wbGVzIjogbGVuKGJhc2VsaW5lX2RhdGEpLAogICAgICAgICAgICAiY3VycmVudF9zYW1wbGVzIjogbGVuKGN1cnJlbnRfZGF0YSkKICAgICAgICB9LAogICAgICAgICJzdGF0dXMiOiAiY3JpdGljYWwiIGlmIGxlbihkcmlmdGVkX2ZlYXR1cmVzKSA+IGxlbihyZXN1bHRzKSAqIDAuMwogICAgICAgICAgICAgICAgICBlbHNlICJ3YXJuaW5nIiBpZiBsZW4oZHJpZnRlZF9mZWF0dXJlcykgPiAwCiAgICAgICAgICAgICAgICAgIGVsc2UgIm9rIgogICAgfQoKIyA9PT09PT09PT09PT09PT09PT09PSBNYWluIEV4ZWN1dGlvbiA9PT09PT09PT09PT09PT09PT09PQoKZGVmIG1haW4oKToKICAgICIiIk1haW4gZnVuY3Rpb24gdG8gY29tcHV0ZSBhbmQgbG9nIGN1c3RvbSBtZXRyaWMuIiIiCiAgICBwcmludCgiPSIgKiA2MCkKICAgIHByaW50KCLwn46vIENvbXB1dGluZyBDdXN0b20gTWV0cmljOiBLb2xtb2dvcm92LVNtaXJub3ZfVGVzdF9kcmlmdCIpCiAgICBwcmludCgiPSIgKiA2MCkKICAgIAogICAgdHJ5OgogICAgICAgICMgTG9hZCBkYXRhCiAgICAgICAgcHJpbnQoIvCfk4ogTG9hZGluZyBiYXNlbGluZSBkYXRhLi4uIikKICAgICAgICBiYXNlbGluZV9kYXRhID0gbG9hZF9iYXNlbGluZV9kYXRhKCkKICAgICAgICAKICAgICAgICBwcmludCgi8J+TiCBMb2FkaW5nIGN1cnJlbnQgZGF0YS4uLiIpCiAgICAgICAgY3VycmVudF9kYXRhID0gbG9hZF9jdXJyZW50X2RhdGEoKQogICAgICAgIAogICAgICAgICMgU2VsZWN0IG9ubHkgbnVtZXJpYyBmZWF0dXJlcwogICAgICAgIG51bWVyaWNfY29scyA9IGJhc2VsaW5lX2RhdGEuc2VsZWN0X2R0eXBlcyhpbmNsdWRlPVtucC5udW1iZXJdKS5jb2x1bW5zCiAgICAgICAgYmFzZWxpbmVfZGF0YSA9IGJhc2VsaW5lX2RhdGFbbnVtZXJpY19jb2xzXQogICAgICAgIGN1cnJlbnRfZGF0YSA9IGN1cnJlbnRfZGF0YVtudW1lcmljX2NvbHNdCiAgICAgICAgCiAgICAgICAgcHJpbnQoZiLinIUgRGF0YSBsb2FkZWQ6IHtsZW4oYmFzZWxpbmVfZGF0YSl9IGJhc2VsaW5lLCB7bGVuKGN1cnJlbnRfZGF0YSl9IGN1cnJlbnQgc2FtcGxlcyIpCiAgICAgICAgCiAgICAgICAgIyBDb21wdXRlIG1ldHJpYwogICAgICAgIHByaW50KCLwn5SNIENvbXB1dGluZyBtZXRyaWMuLi4iKQogICAgICAgIHJlc3VsdCA9IGNvbXB1dGVfbWV0cmljKGJhc2VsaW5lX2RhdGEsIGN1cnJlbnRfZGF0YSkKICAgICAgICBtZXRyaWNfdmFsdWUgPSByZXN1bHRbInZhbHVlIl0KICAgICAgICAKICAgICAgICBwcmludChmIvCfk4ogTWV0cmljIFZhbHVlOiB7bWV0cmljX3ZhbHVlOi40Zn0iKQogICAgICAgIHByaW50KGYi8J+TiCBTdGF0dXM6IHtyZXN1bHQuZ2V0KCdzdGF0dXMnLCAnb2snKX0iKQogICAgICAgIAogICAgICAgICMgSW5pdGlhbGl6ZSBEb21pbm8gY2xpZW50CiAgICAgICAgcHJpbnQoIvCflJcgTG9nZ2luZyBtZXRyaWMgdG8gRG9taW5vLi4uIikKICAgICAgICBkID0gZG9taW5vLkRvbWlubyhET01JTk9fUFJPSkVDVCwgYXBpX2tleT1BUElfS0VZLCBob3N0PUFQSV9IT1NUKQogICAgICAgIG1ldHJpY3NfY2xpZW50ID0gZC5jdXN0b21fbWV0cmljc19jbGllbnQoKQogICAgICAgIAogICAgICAgICMgTG9nIG1ldHJpYwogICAgICAgIHRpbWVzdGFtcCA9IGRhdGV0aW1lLnV0Y25vdygpLmlzb2Zvcm1hdCgpICsgIloiCiAgICAgICAgdGFncyA9IHsKICAgICAgICAgICAgIm1ldHJpY190eXBlIjogIktvbG1vZ29yb3YtU21pcm5vdiBUZXN0IiwKICAgICAgICAgICAgImF1dG9tYXRlZCI6ICJ0cnVlIiwKICAgICAgICAgICAgImpvYl9ydW4iOiAidHJ1ZSIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgbWV0cmljc19jbGllbnQubG9nX21ldHJpYyhNT0RFTF9JRCwgTUVUUklDX05BTUUsIG1ldHJpY192YWx1ZSwgdGltZXN0YW1wLCB0YWdzKQogICAgICAgIHByaW50KCLinIUgTWV0cmljIGxvZ2dlZCBzdWNjZXNzZnVsbHkhIikKCiAgICAgICAgcHJpbnQoIlxuIiArICI9IiAqIDYwKQogICAgICAgIHByaW50KCLinIUgSm9iIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkhIikKICAgICAgICBwcmludCgiPSIgKiA2MCkKICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludChmIuKdjCBKb2IgZmFpbGVkOiB7ZX0iKQogICAgICAgIHJhaXNlCgoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQ==').decode('utf-8')
script_dir = Path('artifacts/custom_metrics')
script_dir.mkdir(parents=True, exist_ok=True)
script_path = script_dir / 'Kolmogorov-Smirnov_Test_drift_job.py'

with open(script_path, 'w') as f:
    f.write(content)

print(f'Created {script_path}')
